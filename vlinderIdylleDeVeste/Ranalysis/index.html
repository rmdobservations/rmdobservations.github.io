<!DOCTYPE html>
<html>
<head>
<title>Index</title>
<meta name="generator" content="Bluefish">
<meta name="author" content="">
<meta name="date" content="">
<meta name="copyright" content="">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="expires" content="0">
<style type="text/css">
table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
}

pre {
background-color: lightgray
}
</style>
</head>
<body>
Houten de Veste
<h2>Workflow</h2>

<h3>Data Exporteren</h3>
<p>Gebruik "van alle jaren per soort, per bezoekdatum, per sectie in een platte tabel. </p>
<img src="images/dataexport.png" width="400" alt="">
<h3>Jaren</h3>

<p><a href="vlindersummary_2019.html" target="_blank">Meetnet tables 2019</a></p>
<p><a href="vlindersummary_2020.html" target="_blank">Meetnet tables 2020</a></p>


<h1>R</h1>
<p>Dit filetype is XLS. Met LibreOffice converteren naar Text .csv (nederlands, inclusief special characters)</p>
<p> Difficult to figure out what class of data is retruned by the R function: <code>readHTMLTable()</code>. Output is one list enclosed within is a data.frame. I spent the last hour trying to give that data frame a name other than NULL
</p>


<p>vlindersummary_oneplot.R</p>
<h2>colors</h2>

<a href="https://github.com/EmilHvitfeldt/r-color-palettes" target="_blank">https://github.com/EmilHvitfeldt/r-color-palettes</a>
<h2>Factors</h2>

<p><code>factor() </code>function, ordered = TRUE allows distinguishing between nominal and ordinal variables.
<a href="Scott.IntroToR.I.R"></a> I had to look
those up. Most likely when I learned this I mixed up ordered and ordinal. 
Same with lists, labels and levels. Number and numeric</p>
<dt>nominal</dt><dd>variables are simply “named” or labeled, with no specific order.</dd>
<dt>ordinal</dt> <dd>variables in a specific order, beyond just naming them</dd>

<p>Something very disturbing about R is when variables containing data are "acted on" by functions. i.e. the value of the variable is changed inside the function. The left side of the equation with an equals sign is IMPLIED. I think I am confused with when output is printed at the console. 
<code>
y<- c(2,3,2)
levels(y)

</code>

<cite> ...specify stringsAsFactors = FALSE ...I then explicitly convert each character column (and other columns
if appropriate) to factors using the factor() function. This allows me to specify both the levels= and the
labels= argument in each factor() function invocation, which in turn makes the pairing of each level with a
corresponding label crystal clear. </cite> from Scott.IntroToR
</p>
<h2>Subsetting Lists (Scott)</h2>
<p><b>vector=unlist(list)</b></p>
<a href="http://adv-r.had.co.nz/Subsetting.html" target="_blank">http://adv-r.had.co.nz/Subsetting.html</a>
<p> Subsetting a list using the single square brackets, [], returns a <b>list</b>! </p>
<p> subsetting a list using the double square brackets, [[ ]], extracts the <b>object </b>that was stored
in the specified component.Because of this, we specify only a single component to be extracted with the
double square brackets – we do not incorporate the colon operator, :, or the c() (concatenate) function.
 </p>
 <p>Because the result of subsetting a list using the double square brackets is the stored object, the result can
then be itself subsetted as demonstrated for vectors, matrices, etc. For example, we can extract the third
column of the comp3 matrix from ourlist using ourlist$comp3[, 3].
</p>
<p>If df is our data frame and v1,
v2, and v3 are its columns, then df[["v1"]], df$v1, and df[, "v1"] are equivalent and they all return a
vector. </p>
<li>With the single square brackets, we indicate which component(s) of the <b>list</b> we would like
to extract. </li>
<li>When the components of a <b>list</b> are not named, we specify the desired component(s) using their
number(s). </li>
<li>first three components using Lst[1:3] </li>
<li>extract the third, fifth, and ninth components using Lst[c(3, 5, 9)]. </li>
<li>Lst[["ComponentName"]] is equivalent to Lst$ComponentName.</li>
<li>subset= argument specifies which <b>rows</b>
of the data frame to keep by using a conditional expression.(do not need dataframe format with $) </li>
<li>The select= argument specifies which <b>columns</b> of the
data frames to select. </li>

<h2>adding columns and manipulating data</h2>
<p>I do not see how to use this yet but seems important to remember.<i>Can’t we use the with() function to add a new variable
to an existing data frame?’ The answer is ‘no’ if we use an expression similar to with(pbc, newvar <-
oldvar*2), but we an expression of the form pbc$newvar <- with(pbc, oldvar*2) will work. A newer
alternative is the within() function – within(pbc, newvar <- oldvar*2).
</i></p>
Combine multiple <b>dataframes</b>: <cite> In terms of data frames,
<li>the cbind() function adds columns of the same length to a data frame. Must have same number of rows </li>
<li>rbind() function adds (concatenates) rows across the same columns. Must have same number of columns and names </li></cite>

<p>So with my butterfly analysis, I can make a giant dataframe with the names of all the butterflies, then duplicate this dataframe 
containing the individual routes. The function <b>merge</b> might do this automatically. But the sectioning would be wrong. Will have to rename
that.</p>

<li>sort() returns original data </li>
<li>order(x, y) will return (print) the <b>index vector</b> which rearranges x (its first
argument) into ascending or descending order, with ties broken by y (its second argument).</li>
<li>use the (unary) - operator to specify that a numeric vector
should be sorted in descending order. </li>


<h2>Conditional</h2>
<p><b> ifelse()</b> works on  a vector: <i>ifelse(condition, expression1, expression2)</i></p>
<h2>Loops</h2>

<cite>When
sequence is a vector, increment loops over each element of the vector (i.e., sequence[increment]). When
sequence is a list, increment refers to each successive component in the list (i.e., sequence[[increment]]).</cite>
<p>lapply (returns list) and sapply (returns vector or matrix): Operates on comonents of list or elements of vector </p>
<p>apply apply function to rows or columns of matrix or dataframe: Uses Margin= to choose row (1), column (2) or both c(1,2)
</p>
<p>tapply, x must be a vector and function must return only one value</p>
<h2>time</h2>
<p>Be careful.</p>
<p> <ol>
	<li>Dates and times have special classes in R that allow for numerical and statistical calculations</li>
	<li>Dates use the Date class</li>
	<li>Times use the POSIXct and POSIXlt class</li>
	<li> Character strings can be coerced to Date/Time classes using the strptime function or the
as.Date, as.POSIXlt, or as.POSIXct</li>

</ol></p>
<p>

<dt><code>df1$bezoekdatum <- strptime(df1$bezoekdatum,"%d-%m-%Y %H:%M")</code></dt><dd>Produces a class "POSIXlt" "POSIXt". Causes a<i>n error in as_tipple: </i>Error: Column `bezoekdatum` is a date/time and must be stored as POSIXct, not POSIXlt. I cannot find a solution to this.</dd>
<dt><code>df1$bezoekdatum <- as.Date(df1$bezoekdatum,"%d-%m-%Y %H:%M")</code></dt><dd>Produces a Date format and removes the time. This one is "tidy and gives no error when converted into a tipple.</dd>
<dt><code>df1$bezoekdatum <- parse_date_time(df1$bezoekdatum,orders="%d-%m-%Y %H:%M",tz="CEST")</code></dt><dd>This one produces a "POSIXct" "POSIXt" and no problems in tibble.</dd>

</p>
<a href="https://ro-che.info/articles/2017-02-22-group_by_month_r" target="_blank">group_by_month_r</a>
<h2>Plotting results</h2>




<table>
<tr>
<td>routenumber</td>
</tr>
<tr>
<td>bezoekdatum</td>
</tr>
<tr>
<td>soort</td>
</tr>
<tr>
<td>wetenschappelijke naam</td>
</tr>
<tr>
<td>sectie</td>
</tr>
<tr>
<td>aantal</td>
</tr>
</table>
<h3>Dropbox</h3>

<p><a href="https://github.com/karthik/rdrop2#create-folders-on-dropbox" target="_parent">https://github.com/karthik/rdrop2#create-folders-on-dropbox</a></p>
<h3>Bar plot</h3>
<cite>ggplot will automatically count the occurrences of each x-axis category in the dataset, and will display the count on the y-axis.</cite>
<a href="https://michaeltoth.me/detailed-guide-to-the-bar-chart-in-r-with-ggplot.html" target="_blank">https://michaeltoth.me/detailed-guide-to-the-bar-chart-in-r-with-ggplot.html</a>
<h3>Working example 2 plots on one graph</h3>
<pre>
<code>
<b>gWindSpeed<-ggplot(df, aes(POSIXtime,WindSpeed)) + 
        geom_line() + 
        geom_smooth()</b>
        
<i>print(gWindSpeed+ggtitle("Wind Speed km/uur"))</i>

  
<b>gWindSpeedFocus<- gWindSpeed + 
        coord_cartesian(xlim =  c(monitorTimeBegin,monitorTimeEnd),
                        ylim=windSpeedLimit)</b>

<i>print(gWindSpeedFocus+ggtitle("Wind Speed Focus km/uur"))</i>

</code>


</pre> 

<table>
<tr>
<td>x</td>
<td>y</td>
<td>type</td>
<td><pre></pre></td>
</tr>
<tr>
<td>soort</td>
<td>NVT</td>
<td>bar</td>
<td><pre>a %>% count(soort)
ggplot(a)+geom_bar(mapping=aes(soort))</pre></td>
</tr>
<tr>
<td>mydate</td>
<td>aantal</td>
<td>points</td>
<td><pre>ggplot(data=a,aes(x=mydate,y=aantal))+
  geom_point()</pre></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><pre># view levels
tib1 %>% count(soort)
tib1 %>% count(sectie)</pre></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><pre></pre></td></tr>
</table>


<h3>Missing Data</h3>

<p>A gap in measurements when I knew that the route had been monitored, alerted me to the "wel gelopen, niet gezien" status in the data set. This also has to be included. The tab is missing in the html table for these days. It looks like readHTMLTable() can deal with this
But it assignes a NA instead of a zero. A zero is a legitimate value.</p>
<p>section 0 has no meaning even though a zero result does. </p>

<table>
<tr>
<td>Code</td>
<td>status</td>
<td>Notes</td>
</tr>
<tr>
<td>practicetidy.R</td>
<td></td>
<td></td>
</tr>
<tr>
<td>vlindersummary_2019</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</table>
<h2>Handy commands</h2>
<table>
<tr>
<td>help("if")</td>
<td>non-standard info </td>
</tr>
<tr>
<td>ls()</td>
<td></td>
</tr>
<tr>
<td>rm()</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>


<p></p>
<p>See also <a href="datasciencedojo/index.html" target="_blank">datascenincedojo web scraping</a></p>
</body>
</html>